version: '2'

services:

    wiki-mongo:
        image: mongo:3.2
        stdin_open: true
        tty: true
        command: mongod --smallfiles --oplogSize 128
        ports:
            - "27017:27017"
        volumes:
             - ./data/mongo:/data/db
    wiki-js:
        build:
            context: ./wikijs
        stdin_open: true
        tty: true
        command: sleep 100000
        volumes:
            - ./data/data:/var/www/wiki/data
            - ./data/repo:/var/www/wiki/repo
            - ./data/keys:/etc/wiki/keys
            - ./data/config.yml:/var/www/wiki/config.yml
        links:
            - wiki-mongo:mongo
        ports:
            - "3000:3000"
            - "80:80"
        expose: 
            - "80"
